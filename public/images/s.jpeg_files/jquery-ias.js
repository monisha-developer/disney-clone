!function(t){"use strict";Date.now=Date.now||function(){return+new Date},t.ias=function(e){function n(){var e;if(C.onChangePage(function(t,e,n){S&&S.setPage(t,n),w.onPageChange.call(this,t,n,e)}),w.triggerPageThreshold>0)i();else if(t(w.next).attr("href")){var n=P.getCurrentScrollOffset(w.scrollContainer);m(function(){c(n)})}return S&&S.havePage()&&(r(),e=S.getPage(),P.forceScrollTop(function(){var n;e>1?(u(e),n=s(!0),t("html, body").scrollTop(n)):i()})),y}function i(){a(),w.scrollContainer.scroll(o)}function o(){var t,e;t=P.getCurrentScrollOffset(w.scrollContainer),e=s(),t>=e&&(f()>=w.triggerPageThreshold?(r(),m(function(){c(t)})):c(t))}function r(){w.scrollContainer.unbind("scroll",o)}function a(){t(w.pagination).hide()}function s(e){var n,i;return n=t(w.container).find(w.item).last(),0===n.size()?0:(i=n.offset().top+n.height(),e||(i+=w.thresholdMargin),i)}function c(e,n){var o;return(o=t(w.next).attr("href"))?void(w.beforePageChange&&t.isFunction(w.beforePageChange)&&w.beforePageChange(e,o)===!1||(C.pushPages(e,o),r(),h(),l(o,function(e,s){var c,l=w.onLoadItems.call(this,s);l!==!1&&(t(s).hide(),c=t(w.container).find(w.item).last(),c.after(s),t(s).fadeIn()),o=t(w.next,e).attr("href"),t(w.pagination).replaceWith(t(w.pagination,e)),d(),a(),o?i():r(),w.onRenderComplete.call(this,s),n&&n.call(this)}))):(w.noneleft&&t(w.container).find(w.item).last().after(w.noneleft),r())}function l(e,n,i){var o,r,a,s=[],c=Date.now();i=i||w.loaderDelay,t.get(e,null,function(e){o=t(w.container,e).eq(0),0===o.length&&(o=t(e).filter(w.container).eq(0)),o&&o.find(w.item).each(function(){s.push(this)}),n&&(a=this,r=Date.now()-c,i>r?setTimeout(function(){n.call(a,e,s)},i-r):n.call(a,e,s))},"html")}function u(e){var n=s(!0);n>0&&c(n,function(){r(),C.getCurPageNum(n)+1<e?(u(e),t("html,body").animate({scrollTop:n},400,"swing")):(t("html,body").animate({scrollTop:n},1e3,"swing"),i())})}function f(){var t=P.getCurrentScrollOffset(w.scrollContainer);return C.getCurPageNum(t)}function g(){var e=t(".ias_loader");return 0===e.size()&&(e=t('<div class="ias_loader">'+w.loader+"</div>"),e.hide()),e}function h(){var e,n=g();w.customLoaderProc!==!1?w.customLoaderProc(n):(e=t(w.container).find(w.item).last(),e.after(n),n.fadeIn())}function d(){var t=g();t.remove()}function p(e){var n=t(".ias_trigger");return 0===n.size()&&(n=t('<div class="ias_trigger"><a href="#">'+w.trigger+"</a></div>"),n.hide()),t("a",n).unbind("click").bind("click",function(){return v(),e.call(),!1}),n}function m(e){var n,i=p(e);w.customTriggerProc!==!1?w.customTriggerProc(i):(n=t(w.container).find(w.item).last(),n.after(i),i.fadeIn())}function v(){var t=p();t.remove()}var w=t.extend({},t.ias.defaults,e),P=new t.ias.util,C=new t.ias.paging(w.scrollContainer),S=w.history?new t.ias.history:!1,y=this;n()},t.ias.defaults={container:"#container",scrollContainer:t(window),item:".item",pagination:"#pagination",next:".next",noneleft:!1,loader:'<img src="images/loader.gif"/>',loaderDelay:600,triggerPageThreshold:3,trigger:"Load more items",thresholdMargin:0,history:!0,onPageChange:function(){},beforePageChange:function(){},onLoadItems:function(){},onRenderComplete:function(){},customLoaderProc:!1,customTriggerProc:!1},t.ias.util=function(){function e(){t(window).load(function(){n=!0})}var n=!1,i=!1,o=this;e(),this.forceScrollTop=function(e){t("html,body").scrollTop(0),i||(n?(e.call(),i=!0):setTimeout(function(){o.forceScrollTop(e)},1))},this.getCurrentScrollOffset=function(t){var e,n;return e=t.get(0)===window?t.scrollTop():t.offset().top,n=t.height(),e+n}},t.ias.paging=function(){function e(){t(window).scroll(n)}function n(){var e,n,r,l,u;e=c.getCurrentScrollOffset(t(window)),n=i(e),r=o(e),s!==n&&(l=r[0],u=r[1],a.call({},n,l,u)),s=n}function i(t){for(var e=r.length-1;e>0;e--)if(t>r[e][0])return e+1;return 1}function o(t){for(var e=r.length-1;e>=0;e--)if(t>r[e][0])return r[e];return null}var r=[[0,document.location.toString()]],a=function(){},s=1,c=new t.ias.util;e(),this.getCurPageNum=function(e){return e=e||c.getCurrentScrollOffset(t(window)),i(e)},this.onChangePage=function(t){a=t},this.pushPages=function(t,e){r.push([t,e])}},t.ias.history=function(){function t(){n=!!(window.history&&history.pushState&&history.replaceState),n=!1}var e=!1,n=!1;t(),this.setPage=function(t,e){this.updateState({page:t},"",e)},this.havePage=function(){return this.getState()!==!1},this.getPage=function(){var t;return this.havePage()?(t=this.getState(),t.page):1},this.getState=function(){var t,e,i;if(n){if(e=history.state,e&&e.ias)return e.ias}else if(t="#/page/"===window.location.hash.substring(0,7))return i=parseInt(window.location.hash.replace("#/page/",""),10),{page:i};return!1},this.updateState=function(t,n,i){e?this.replaceState(t,n,i):this.pushState(t,n,i)},this.pushState=function(t,i,o){var r;n?history.pushState({ias:t},i,o):(r=t.page>0?"#/page/"+t.page:"",window.location.hash=r),e=!0},this.replaceState=function(t,e,i){n?history.replaceState({ias:t},e,i):this.pushState(t,e,i)}}}(jQuery);