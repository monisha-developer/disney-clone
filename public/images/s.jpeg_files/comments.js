(function(){var form=document.querySelector('#commentform');form.addEventListener('submit',function(event){event.preventDefault();var commentList=document.querySelector('.comment-list');var respond=document.querySelector('#respond');var comment=document.querySelector('#comment');var submit=document.querySelector('#submit');var submitvalue=submit.value;var formData=new FormData(form);formData.append('action','wgtcnewcomment');Array.from(form.elements).forEach(function(formElement){formElement.disabled=true;});submit.value='Posting...';fetch(wgtc_comments_params.endpoint,{method:'POST',body:formData,}).then(function(response){if(!response.ok){throw response;}else{return response.text();}}).then(function(html){var temp=document.createElement('div');temp.innerHTML=html;var newComment=temp.children[0];if(commentList){if(respond.parentElement.classList.contains('comment')){if(respond.parentElement.querySelector('.children')){respond.parentElement.querySelector('.children').lastChild.after(newComment);}else{respond.after(newComment);}
document.querySelector('#cancel-comment-reply-link').click();}else{commentList.lastChild.after(newComment);}}else{respond.after(newComment);}
if(document.querySelector('.comment-count')){document.querySelector('.comment-count').textContent=parseInt(document.querySelector('.comment-count').textContent)+1;}
comment.value='';}).catch(function(error){console.error(error);}).finally(function(){Array.from(form.elements).forEach(function(formElement){formElement.disabled=false;});submit.value=submitvalue;});return false;});})();